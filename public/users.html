<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" data-testid="meta-charset" />
  <title data-testid="title">User Management</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" data-testid="meta-viewport" />

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    data-testid="bootstrap-css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    data-testid="bootstrap-js"></script>

  <!-- Scripts -->
  <script type="module" src="/_js/validation.js" data-testid="script-validation"></script>
  <script type="module" src="/_js/main.js" data-testid="script-main"></script>
  <script type="module" src="/_js/logout.js" data-testid="script-logout"></script>
  <script type="module" src="/_js/timerExpires.js" data-testid="script-timer"></script>
  <script type="module" src="/_js/ui.js" data-testid="script-ui"></script>
  <script type="module">
    import { maskCPF, formatDate, formatMoney } from "/_js/validation.js";

    const cpfInput = document.getElementById("cpf");
    if (cpfInput) {
      cpfInput.addEventListener("input", () => {
        cpfInput.value = maskCPF(cpfInput.value);
      });
    }

    const salaryInput = document.getElementById("salary");
    if (salaryInput) {
      salaryInput.addEventListener("input", () => {
        let value = salaryInput.value.replace(/\D/g, "");
        if (value) {
          salaryInput.value = formatMoney(Number(value) / 100);
        }
      });
    }

    const salaryEditInput = document.getElementById("editSalary");
    if (salaryEditInput) {
      salaryEditInput.addEventListener("input", () => {
        let value = salaryEditInput.value.replace(/\D/g, "");
        if (value) {
          salaryEditInput.value = formatMoney(Number(value) / 100);
        }
      });
    }
  </script>

  <link href="/_css/styles.css" rel="stylesheet" data-testid="styles" />
</head>

<body class="bg-light" data-testid="body">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark" data-testid="navbar">
    <div class="container-fluid" data-testid="navbar-container">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        data-testid="navbar-toggler">
        <span class="navbar-toggler-icon" data-testid="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-between" id="navbarNav" data-testid="navbar-collapse">
        <ul class="navbar-nav" data-testid="navbar-list">
          <li class="nav-item" data-testid="nav-item-users">
            <a class="nav-link active" href="/users.html" data-testid="nav-link-users">Users</a>
          </li>
        </ul>
        <div class="d-flex align-items-center text-white" data-testid="navbar-right">
          <span class="me-3" id="sessionTimer" data-testid="session-timer">Session expires in: ...</span>
          <button id="logoutBtn" class="btn btn-sm btn-danger" data-testid="logout-btn">
            Logout
          </button>
        </div>
      </div>
    </div>
  </nav>

  <div class="container my-4" data-testid="container">
    <!-- Add User Form -->
    <div class="card mb-4" data-testid="add-user-card">
      <div class="card-header" data-testid="add-user-header">Add User</div>
      <div class="card-body" data-testid="add-user-body">
        <form id="userForm" class="row g-3" data-testid="user-form">
          <div class="col-md-4 col-12" data-testid="cpf-container">
            <input type="text" id="cpf" class="form-control" placeholder="CPF" maxlength="14" required
              data-testid="cpf-input" />
          </div>
          <div class="col-md-4 col-12" data-testid="firstname-container">
            <input type="text" id="firstName" class="form-control" placeholder="First name" maxlength="60" required
              data-testid="firstname-input" />
          </div>
          <div class="col-md-4 col-12" data-testid="lastname-container">
            <input type="text" id="lastName" class="form-control" placeholder="Last name" maxlength="60" required
              data-testid="lastname-input" />
          </div>
          <div class="col-md-4 col-12" data-testid="birthdate-container">
            <input type="date" id="birthDate" class="form-control" required data-testid="birthdate-input" />
          </div>
          <div class="col-md-4 col-12" data-testid="occupation-container">
            <input type="text" id="occupation" class="form-control" placeholder="Occupation" maxlength="60" required
              data-testid="occupation-input" />
          </div>
          <div class="col-md-4 col-12" data-testid="employmentType-container">
            <select id="employmentType" class="form-select form-control" required data-testid="employment-type-select">
              <option value="">Select employment type</option>
              <option value="CLT">CLT</option>
              <option value="PJ">PJ</option>
              <option value="Intern">Intern</option>
              <option value="Contractor">Contractor</option>
            </select>
          </div>
          <div class="col-md-4 col-12" data-testid="salary-container">
            <input type="text" id="salary" class="form-control" placeholder="Salary" required
              data-testid="salary-input" />
          </div>
          <div class="col-12 d-flex gap-2" data-testid="form-actions">
            <button type="submit" class="btn btn-primary flex-fill" data-testid="save-btn">
              Save
            </button>
            <button type="reset" class="btn btn-secondary flex-fill" data-testid="reset-btn">
              Reset
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Edit User Modal -->
    <div class="modal fade" id="editUserModal" tabindex="-1" aria-hidden="true" data-testid="edit-user-modal">
      <div class="modal-dialog modal-dialog-centered modal-lg" data-testid="edit-user-dialog">
        <div class="modal-content" data-testid="edit-user-content">
          <div class="modal-header" data-testid="edit-user-header">
            <h5 class="modal-title" data-testid="edit-user-title">
              Edit User
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" data-testid="edit-user-close"></button>
          </div>
          <div class="modal-body" data-testid="edit-user-body">
            <form id="editUserForm" class="row g-3" data-testid="edit-user-form">
              <input type="hidden" id="editId" data-testid="edit-id" />
              <div class="col-md-6 col-12" data-testid="edit-firstname-container">
                <input type="text" id="editFirstName" class="form-control" placeholder="First Name" required
                  data-testid="edit-firstname-input" />
              </div>
              <div class="col-md-6 col-12" data-testid="edit-lastname-container">
                <input type="text" id="editLastName" class="form-control" placeholder="Last Name" required
                  data-testid="edit-lastname-input" />
              </div>
              <div class="col-md-6 col-12" data-testid="edit-birthdate-container">
                <input type="date" id="editBirthDate" class="form-control" required
                  data-testid="edit-birthdate-input" />
              </div>
              <div class="col-md-6 col-12" data-testid="edit-occupation-container">
                <input type="text" id="editOccupation" class="form-control" placeholder="Occupation" required
                  data-testid="edit-occupation-input" />
              </div>
              <div class="col-md-6 col-12">
                <select id="editEmploymentType" class="form-select" required data-testid="edit-employment-type-select">
                  <option value="">Select employment type</option>
                  <option value="CLT">CLT</option>
                  <option value="PJ">PJ</option>
                  <option value="Intern">Intern</option>
                  <option value="Contractor">Contractor</option>
                </select>
              </div>
              <div class="col-12" data-testid="edit-salary-container">
                <input type="text" id="editSalary" class="form-control" placeholder="Salary" required
                  data-testid="edit-salary-input" />
              </div>
            </form>
          </div>
          <div class="modal-footer" data-testid="edit-user-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-testid="edit-cancel-btn">
              Cancel
            </button>
            <button type="button" id="saveEdit" class="btn btn-primary" data-testid="edit-save-btn">
              Save changes
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Feedback Modal -->
    <div class="modal fade" id="alertModal" tabindex="-1" aria-hidden="true" data-testid="alert-modal">
      <div class="modal-dialog modal-dialog-centered" data-testid="alert-dialog">
        <div class="modal-content" data-testid="alert-content">
          <div class="modal-header" data-testid="alert-header">
            <h5 class="modal-title" id="alertModalTitle" data-testid="alert-title">
              Message
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" data-testid="alert-close"></button>
          </div>
          <div class="modal-body" id="alertModalBody" data-testid="alert-body"></div>
          <div class="modal-footer" data-testid="alert-footer">
            <button type="button" class="btn btn-primary" data-bs-dismiss="modal" data-testid="alert-ok-btn">
              OK
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Delete User Modal -->
    <div class="modal fade" id="deleteUserModal" tabindex="-1" aria-hidden="true" data-testid="delete-user-modal">
      <div class="modal-dialog modal-dialog-centered" data-testid="delete-dialog">
        <div class="modal-content" data-testid="delete-content">
          <div class="modal-header" data-testid="delete-header">
            <h5 class="modal-title" data-testid="delete-title">
              Delete User
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" data-testid="delete-close"></button>
          </div>
          <div class="modal-body" data-testid="delete-body">
            <p data-testid="delete-text">
              Are you sure you want to delete
              <span id="deleteUserName" class="fw-bold" data-testid="delete-username"></span>?
            </p>
            <input type="hidden" id="deleteId" data-testid="delete-id" />
          </div>
          <div class="modal-footer" data-testid="delete-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-testid="delete-cancel-btn">
              Cancel
            </button>
            <button type="button" id="confirmDeleteBtn" class="btn btn-danger" data-testid="delete-confirm-btn">
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Search Box -->
    <div class="mb-3" data-testid="search-container">
      <input type="text" id="searchInput" class="form-control" placeholder="Search users..."
        data-testid="search-input" />
    </div>

    <!-- User Table -->
    <div class="card" data-testid="user-table-card">
      <div class="card-header" data-testid="user-table-header">Users</div>
      <div class="card-body table-responsive" data-testid="user-table-body">
        <table class="table table-striped table-hover table-bordered" data-testid="user-table">
          <thead class="table-dark" data-testid="user-table-head">
            <tr data-testid="user-table-head-row">
              <th data-testid="th-id">ID</th>
              <th data-testid="th-cpf">CPF</th>
              <th data-testid="th-name">Name</th>
              <th data-testid="th-birthdate">Birth date</th>
              <th data-testid="th-occupation">Occupation</th>
              <th data-testid="th-employmentType">Employment type</th>
              <th data-testid="th-salary">Salary</th>
              <th data-testid="th-actions">Actions</th>
            </tr>
          </thead>
          <tbody id="userTable" data-testid="user-table-body-content"></tbody>
        </table>
      </div>
    </div>
  </div>
</body>

</html>